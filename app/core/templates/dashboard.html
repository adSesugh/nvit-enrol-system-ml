{% extends 'base.html' %}

{% block title %} Dashboard {% endblock %}

{% block content %}
    <div class="row">
        <div class="col-sm-12 mb-4 mb-xl-0">
            <h4 class="font-weight-bold text-dark">Hi, welcome back!</h4>
            <p class="font-weight-normal mb-2 text-muted">{{ current_user.full_name }}</p>
        </div>
    </div>
    <div class="row mt-3">
        <div class="col-xl-5 flex-column d-flex grid-margin">
            <div class="row grid-margin">
                <div class="col-sm-6">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="card-title">Applications</h4>
                            <h4 class="text-dark font-weight-bold mb-2">2278</h4>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="card-title">WB Expected</h4>
                            <h4 class="text-dark font-weight-bold mb-2">860</h4>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row grid-margin">
                <div class="col-sm-6">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="card-title">Total Online Applications</h4>
                            <h4 class="text-dark font-weight-bold mb-2">1511</h4>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="card-title">Total Onsite Applications</h4>
                            <h4 class="text-dark font-weight-bold mb-2">767</h4>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row grid-margin">
                <div class="col-sm-6">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="card-title">Admitted</h4>
                            <h4 class="text-dark font-weight-bold mb-2">{{ records.captured }}</h4>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="card-title">Available Courses</h4>
                            <h4 class="text-dark font-weight-bold mb-2">6</h4>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row grid-margin">
                <div class="col-sm-6">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="card-title">Not Admitted</h4>
                            <h4 class="text-dark font-weight-bold mb-2">1418</h4>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="card-title">Biometric Captured</h4>
                            <h4 class="text-dark font-weight-bold mb-2">1081</h4>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row grid-margin">
                <div class="col-lg-12">
                    <div class="card">
                        <div class="card-body">
                            <h2 class="card-title">Online Application Distribution</h2>
                            <table class="table d-lg-table">
                                <tr>
                                    <th></th>
                                    <th>Female</th>
                                    <th>Male</th>
                                </tr>
                                <tr>
                                    <th>PWD</th>
                                    <td>3</td>
                                    <td>12</td>
                                </tr>
                                <tr>
                                    <th>Normal</th>
                                    <td>334</td>
                                    <td>1162</td>
                                </tr>
                                <tr>
                                    <th>Total</th>
                                    <th>337</th>
                                    <th>1174</th>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12 my-1">
                    <div class="card">
                        <div class="card-body">
                            <h2 class="card-title">In-Person Application Distribution</h2>
                            <table class="table d-lg-table">
                                <tr>
                                    <th></th>
                                    <th>Female</th>
                                    <th>Male</th>
                                </tr>
                                <tr>
                                    <th>PWD</th>
                                    <td>0</td>
                                    <td>2</td>
                                </tr>
                                <tr>
                                    <th>Normal</th>
                                    <td>235</td>
                                    <td>530</td>
                                </tr>
                                <tr>
                                    <th>Total</th>
                                    <th>235</th>
                                    <th>531</th>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12 my-1">
                    <div class="card">
                        <div class="card-body">
                            <h2 class="card-title">Total Admitted</h2>
                            <table class="table d-lg-table">
                                <tr>
                                    <th></th>
                                    <th>Female</th>
                                    <th>Male</th>
                                </tr>
                                <tr>
                                    <th>PWD</th>
                                    <td>1</td>
                                    <td>9</td>
                                </tr>
                                <tr>
                                    <th>Normal</th>
                                    <td>234</td>
                                    <td>616</td>
                                </tr>
                                <tr>
                                    <th>Total</th>
                                    <th>235</th>
                                    <th>625</th>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="row">
                        <div class="col-lg-6">
                            <div class="card">
                                <div class="card-body">
                                    <h3 class="card-title" style="font-size: 10px;">Online Application by State</h3>
                                    <table class="table">
                                        <tr>
                                            <th>State</th>
                                            <th>Total</th>
                                        </tr>
                                        <tr>
                                            <td>Abia</td>
                                            <td>13</td>
                                        </tr>
                                        <tr>
                                            <td>Akwa Ibom</td>
                                            <td>13</td>
                                        </tr>
                                        <tr>
                                            <td>Adamawa</td>
                                            <td>7</td>
                                        </tr>
                                        <tr>
                                            <td>Anambra</td>
                                            <td>12</td>
                                        </tr>
                                        <tr>
                                            <td>Bayelsa</td>
                                            <td>1</td>
                                        </tr>
                                        <tr>
                                            <td>Bauchi</td>
                                            <td>5</td>
                                        </tr>
                                        <tr>
                                            <td>Benue</td>
                                            <td>1120</td>
                                        </tr>
                                        <tr>
                                            <td>Borno</td>
                                            <td>8</td>
                                        </tr>
                                        <tr>
                                            <td>Cross River</td>
                                            <td>11</td>
                                        </tr>
                                        <tr>
                                            <td>Delta</td>
                                            <td>19</td>
                                        </tr>
                                        <tr>
                                            <td>Ebonyi</td>
                                            <td>10</td>
                                        </tr>
                                        <tr>
                                            <td>Benin</td>
                                            <td>14</td>
                                        </tr>
                                        <tr>
                                            <td>Ekiti</td>
                                            <td>5</td>
                                        </tr>
                                        <tr>
                                            <td>Enugu</td>
                                            <td>30</td>
                                        </tr>
                                        <tr>
                                            <td>FCT</td>
                                            <td>4</td>
                                        </tr>
                                        <tr>
                                            <td>Gombe</td>
                                            <td>6</td>
                                        </tr>
                                        <tr>
                                            <td>Imo</td>
                                            <td>11</td>
                                        </tr>
                                        <tr>
                                            <td>Jigawa</td>
                                            <td>19</td>
                                        </tr>
                                        <tr>
                                            <td>Kaduna</td>
                                            <td>17</td>
                                        </tr>
                                        <tr>
                                            <td>Kano</td>
                                            <td>11</td>
                                        </tr>
                                        <tr>
                                            <td>Katsina</td>
                                            <td>3</td>
                                        </tr>
                                        <tr>
                                            <td>Kogi</td>
                                            <td>63</td>
                                        </tr>
                                        <tr>
                                            <td>Kwara</td>
                                            <td>5</td>
                                        </tr>
                                        <tr>
                                            <td>Kebbi</td>
                                            <td>1</td>
                                        </tr>
                                        <tr>
                                            <td>Lagos</td>
                                            <td>1</td>
                                        </tr>
                                        <tr>
                                            <td>Nasarawa</td>
                                            <td>9</td>
                                        </tr>
                                        <tr>
                                            <td>Niger</td>
                                            <td>3</td>
                                        </tr>
                                        <tr>
                                            <td>Ogun</td>
                                            <td>9</td>
                                        </tr>
                                        <tr>
                                            <td>Ondo</td>
                                            <td>16</td>
                                        </tr>
                                        <tr>
                                            <td>Osun</td>
                                            <td>14</td>
                                        </tr>
                                        <tr>
                                            <td>Oyo</td>
                                            <td>18</td>
                                        </tr>
                                        <tr>
                                            <td>Plateau</td>
                                            <td>10</td>
                                        </tr>
                                        <tr>
                                            <td>Rivers</td>
                                            <td>12</td>
                                        </tr>
                                        <tr>
                                            <td>Taraba</td>
                                            <td>7</td>
                                        </tr>
                                        <tr>
                                            <td>Yobe</td>
                                            <td>2</td>
                                        </tr>
                                        <tr>
                                            <td>Zamfara</td>
                                            <td>3</td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="card">
                                <div class="card-body">
                                    <h3 class="card-title" style="font-size: 10px;">In-Person Application by State</h3>
                                    <table class="table">
                                        <tr>
                                            <th>State</th>
                                            <th>Total</th>
                                        </tr>
                                        <tr>
                                            <td>Abia</td>
                                            <td>5</td>
                                        </tr>
                                        <tr>
                                            <td>Akwa Ibom</td>
                                            <td>4</td>
                                        </tr>
                                        <tr>
                                            <td>Anambra</td>
                                            <td>6</td>
                                        </tr>
                                        <tr>
                                            <td>Bayelsa</td>
                                            <td>1</td>
                                        </tr>
                                        <tr>
                                            <td>Benue</td>
                                            <td>752</td>
                                        </tr>
                                        <tr>
                                            <td>Borno</td>
                                            <td>1</td>
                                        </tr>
                                        <tr>
                                            <td>Cross River</td>
                                            <td>4</td>
                                        </tr>
                                        <tr>
                                            <td>Delta</td>
                                            <td>3</td>
                                        </tr>
                                        <tr>
                                            <td>Ebonyi</td>
                                            <td>1</td>
                                        </tr>
                                        <tr>
                                            <td>Benin</td>
                                            <td>4</td>
                                        </tr>
                                        <tr>
                                            <td>Enugu</td>
                                            <td>21</td>
                                        </tr>
                                        <tr>
                                            <td>FCT</td>
                                            <td>1</td>
                                        </tr>
                                        <tr>
                                            <td>Gombe</td>
                                            <td>1</td>
                                        </tr>
                                        <tr>
                                            <td>Imo</td>
                                            <td>7</td>
                                        </tr>
                                        <tr>
                                            <td>Jigawa</td>
                                            <td>2</td>
                                        </tr>
                                        <tr>
                                            <td>Kaduna</td>
                                            <td>3</td>
                                        </tr>
                                        <tr>
                                            <td>Kano</td>
                                            <td>1</td>
                                        </tr>
                                        <tr>
                                            <td>Katsina</td>
                                            <td>1</td>
                                        </tr>
                                        <tr>
                                            <td>Kogi</td>
                                            <td>17</td>
                                        </tr>
                                        <tr>
                                            <td>Kwara</td>
                                            <td>3</td>
                                        </tr>
                                        <tr>
                                            <td>Nasarawa</td>
                                            <td>2</td>
                                        </tr>
                                        <tr>
                                            <td>Niger</td>
                                            <td>3</td>
                                        </tr>
                                        <tr>
                                            <td>Ogun</td>
                                            <td>1</td>
                                        </tr>
                                        <tr>
                                            <td>Ondo</td>
                                            <td>6</td>
                                        </tr>
                                        <tr>
                                            <td>Osun</td>
                                            <td>3</td>
                                        </tr>
                                        <tr>
                                            <td>Oyo</td>
                                            <td>4</td>
                                        </tr>
                                        <tr>
                                            <td>Plateau</td>
                                            <td>2</td>
                                        </tr>
                                        <tr>
                                            <td>Rivers</td>
                                            <td>1</td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xl-7 d-flex flex-column grid-margin stretch-card">
            <div class="card my-1 w-100">
                <div class="card-body">
                    <h5 class="card-title">Admitted Applicants Distribution</h5>
                    <table class="table table-striped">
                        <tr>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">Others</h5>
                                    </div>
                                    <h6 class="card-text">8</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">Self Employed</h5>
                                    </div>
                                    <h6 class="card-text">283</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">Unemployed</h5>
                                    </div>
                                    <h6 class="card-text">569</h6>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="card my-1 w-100">
                <div class="card-body">
                    <h5 class="card-title">Online Applicants Employment Status</h5>
                    <table class="table table-striped">
                        <tr>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">Others</h5>
                                    </div>
                                    <h6 class="card-text">27</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">Self Employed</h5>
                                    </div>
                                    <h6 class="card-text">301</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">Employed</h5>
                                    </div>
                                    <h6 class="card-text">194</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">Unemployed</h5>
                                    </div>
                                    <h6 class="card-text">989</h6>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="card my-1 w-100">
                <div class="card-body">
                    <h5 class="card-title">In-Person Applicantion Employment Status</h5>
                    <table class="table table-striped">
                        <tr>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">Employed</h5>
                                    </div>
                                    <h6 class="card-text">27</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">Unemployed</h5>
                                    </div>
                                    <h6 class="card-text">740</h6>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="card my-1 w-100">
                <div class="card-body">
                    <h5 class="card-title">Online Applicants Education Level</h5>
                    <table class="table table-striped">
                        <tr>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">Bachelor degree</h5>
                                    </div>
                                    <h6 class="card-text">694</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">Diploma/Others</h5>
                                    </div>
                                    <h6 class="card-text">294</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">Doctorate (PhD)</h5>
                                    </div>
                                    <h6 class="card-text">5</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">High School</h5>
                                    </div>
                                    <h6 class="card-text">244</h6>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="card my-1 w-100">
                <div class="card-body">
                    <h5 class="card-title">In-Person Application Education Level</h5>
                    <table class="table table-striped">
                        <tr>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">Bachelor degree</h5>
                                    </div>
                                    <h6 class="card-text">293</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">HND</h5>
                                    </div>
                                    <h6 class="card-text">115</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">NCE</h5>
                                    </div>
                                    <h6 class="card-text">64</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">ND</h5>
                                    </div>
                                    <h6 class="card-text">68</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">Masters</h5>
                                    </div>
                                    <h6 class="card-text">24</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">PGD</h5>
                                    </div>
                                    <h6 class="card-text">14</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">PhD</h5>
                                    </div>
                                    <h6 class="card-text">1</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">SSCE</h5>
                                    </div>
                                    <h6 class="card-text">280</h6>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="card my-1 w-100">
                <div class="card-body">
                    <h5 class="card-title">Admitted Applicants Distribution against Courses</h5>
                    <table class="table table-striped">
                        <tr>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">ITSO</h5>
                                    </div>
                                    <h6 class="card-text">77</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">AIML</h5>
                                    </div>
                                    <h6 class="card-text">69</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">FSPD</h5>
                                    </div>
                                    <h6 class="card-text">226</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">ACDE</h5>
                                    </div>
                                    <h6 class="card-text">128</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">ADSE</h5>
                                    </div>
                                    <h6 class="card-text">186</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">UIUX</h5>
                                    </div>
                                    <h6 class="card-text">174</h6>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="card my-1 w-100">
                <div class="card-body">
                    <h5 class="card-title">Captured but not admitted</h5>
                    <table class="table table-striped">
                        <tr>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">Total</h5>
                                    </div>
                                    <h6 class="card-text">221</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">Female</h5>
                                    </div>
                                    <h6 class="card-text">78</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">Male</h5>
                                    </div>
                                    <h6 class="card-text">143</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">Disabled Female</h5>
                                    </div>
                                    <h6 class="card-text">0</h6>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <div class="my-1">
                                        <h5 class="card-title">Disabled Male</h5>
                                    </div>
                                    <h6 class="card-text">2</h6>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="card p-5 mb-3 d-flex flex-row" style="height: 350px;">
                        <div class="col-lg-6">
                            <h4 class="card-title">Age Range of Admitted Distribution</h4>
                            <canvas id="demographyChart"></canvas>
                        </div>
                        <div class="col-lg-6">
                            <h4 class="card-title">Disabled & non-disabled Distribution against courses</h4>
                            <canvas id="femaleMaleChart" height="250" class="my-4"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card mb-3">
              <div class="card-body">
                    <div class="mb-5">
                        <h4 class="card-title">Applicant distribution against courses</h4>
                        <div class="row">
                            <div class="col-sm-12">
                                <canvas id="coursesChart" height="200" class="mt-3"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="dropdown-divider my-3"></div>
                    <div class="mb-4">
                        <h4 class="card-title">Not Admitted Applicant distribution against courses</h4>
                        <div class="row">
                            <div class="col-sm-12">
                                <canvas id="notCoursesChart" height="200" class="mt-3"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="row my-2">
                        <div class="card-header mt-2">
                            <h4 class="card-title mb-1">Code Description</h4>
                        </div>
                        <div class="row">
                            {% for (index, code) in enumerate(records.stats.labels) %}
                                <div class="col-12 my-1 card-text" style="font-size: 12px;">{{ code }} - {{ records.stats.courses[index] }}</div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
              </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script>
        const ctx = document.getElementById('coursesChart')
        const notAdmittedCtx = document.getElementById('notCoursesChart')
        const ctx_disabled = document.getElementById('femaleMaleChart')
        const demographyChart = document.getElementById('demographyChart')

        var labels = {{ records.stats.labels|tojson }};
        var course_data = {{ records.stats.data|tojson }};

        var not_admitted_labels = {{ records.stats.labels|tojson }};
        var not_admitted_course_data = {{ records.stats.not_admitted_data|tojson }};

        new Chart(demographyChart, {
            type: 'doughnut',
            data: {
                labels: ['15 - 24yrs', '25 - 35yrs', '36 above'],
                datasets: [{
                    label: 'Age Range',
                    data: [250, 407, 203],
                    backgroundColor: [
                        'rgb(255, 99, 132)',
                        'rgb(54, 162, 235)',
                        'rgb(255, 205, 86)'
                    ],
                    hoverOffset: 4
                }]
            }
        })

        new Chart(notAdmittedCtx, {
            type: 'bar',
            data: {
              labels: not_admitted_labels,
              datasets: [{
                label: 'Not Admitted Applicants',
                data: not_admitted_course_data,
                borderWidth: 1,
                minBarLength: 2,
              }]
            },
            options: {
                scales: {
                    y: {
                    beginAtZero: true,
                        grid: {
                            display: false
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                },
                indexAxis: 'y',
                plugins: {
                    datalabels: {
                        formatter: function(value, context) {
                            return context.chart.data.labels[context.dataIndex];
                        }
                    }
                }
            }
        });

        new Chart(ctx, {
            type: 'bar',
            data: {
              labels: labels,
              datasets: [{
                label: 'Applicants per course',
                data: course_data,
                borderWidth: 1,
                minBarLength: 2,
              }]
            },
            options: {
                scales: {
                    y: {
                    beginAtZero: true,
                        grid: {
                            display: false
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                },
                indexAxis: 'y',
                plugins: {
                    datalabels: {
                        formatter: function(value, context) {
                            return context.chart.data.labels[context.dataIndex];
                        }
                    }
                }
            }
        });

        document.addEventListener('DOMContentLoaded', function () {
            var statsdata = {{ stats_data | tojson | safe }};

            console.log(statsdata)

            // Organize data into separate arrays for Chart.js
            var pwd_labels = Array.from(new Set(statsdata.map(item => item.course_of_study)));
            var disabledNoData = [];
            var disabledYesData = [];

            // Populate data arrays
            pwd_labels.forEach(function (label) {
                var disabledNoCount = statsdata.filter(item => item.course_of_study === label && item.disabled === 'no').reduce((acc, cur) => acc + cur.count, 0);
                var disabledYesCount = statsdata.filter(item => item.course_of_study === label && item.disabled === 'yes').reduce((acc, cur) => acc + cur.count, 0);

                disabledNoData.push(disabledNoCount ? disabledNoCount : null);
                disabledYesData.push(disabledYesCount ? disabledYesCount : null);
            });

            console.log(disabledNoData)

            var ctx = document.getElementById('femaleMaleChart').getContext('2d');
            var femaleMaleChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: pwd_labels,
                    datasets: [
                        { label: 'Disabled: No', data: disabledNoData, borderColor: 'blue', fill: false },
                        { label: 'Disabled: Yes', data: disabledYesData, borderColor: 'red', fill: false }
                    ]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                display: false
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        });
    </script>
{% endblock %}